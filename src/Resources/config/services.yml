imports:
    - { resource: "services/**/*.yml" }

services:
    bitbag_sylius_multi_cart_plugin.controller.show_carts:
        class: BitBag\SyliusMultiCartPlugin\Controller\ShowCartsController
        arguments:
            - '@sylius.context.customer'
            - '@sylius.context.channel'
            - '@sylius.repository.order'
        tags:
            - { name: 'controller.service_arguments' }
        calls:
            - [setContainer, ['@service_container']]

    bitbag_sylius_multi_cart_plugin.controller.new_cart:
#    BitBag\SyliusMultiCartPlugin\Controller\NewCartAction:
#        public: true
        class: BitBag\SyliusMultiCartPlugin\Controller\NewCartAction
        arguments:
            - '@sylius.context.cart.new_shop_based'
            - '@doctrine.orm.entity_manager'
            - "@router"
            - '@sylius.context.customer'
        tags:
            - { name: 'controller.service_arguments' }
#            - { name: 'container.service_subscriber' }
#        calls:
#            - [setContainer, ['@service_container']]

    bitbag_sylius_multi_cart_plugin.controller.change_active_cart:
        class: BitBag\SyliusMultiCartPlugin\Controller\ChangeActiveCartAction
        arguments:
            - '@sylius.context.customer'
            - '@doctrine.orm.entity_manager'
        tags:
            - { name: 'controller.service_arguments' }

    bitbag_sylius_multi_cart_plugin.controller.ajax_cart:
        class: BitBag\SyliusMultiCartPlugin\Controller\AjaxCartAction
        arguments:
            - '@sylius.context.cart'
            - '@twig'
        tags:
            - { name: 'controller.service_arguments' }

    bitbag_sylius_multi_cart_plugin.controller.get_active_cart:
        class: BitBag\SyliusMultiCartPlugin\Controller\GetActiveCartAction
        arguments:
            - '@sylius.context.channel'
            - '@sylius.context.customer'
            - '@sylius.repository.order'
            - '@serializer'
        tags:
            - { name: 'controller.service_arguments' }

    bitbag_sylius_multi_cart_plugin.controller.delete_cart:
        class: BitBag\SyliusMultiCartPlugin\Controller\DeleteCartAction
        arguments:
            - '@sylius.context.channel'
            - '@sylius.context.customer'
            - '@sylius.repository.order'
            - '@doctrine.orm.entity_manager'
            - "@router"
        tags:
            - { name: 'controller.service_arguments' }

#   dorobić skrót do dekoratora
    BitBag\SyliusMultiCartPlugin\Cart\Context\CustomerAndChannelBasedMultiCartContext:
        decorates: 'sylius.context.cart.customer_and_channel_based'
        arguments:
            - '@sylius.context.customer'
            - '@sylius.context.channel'
            - '@sylius.repository.order'
        tags:
            - {name: 'sylius.context.cart'}

#            <argument type="service" id="sylius.context.customer" />
#            <argument type="service" id="sylius.context.channel" />
#            <argument type="service" id="sylius.repository.order" />
#            <tag name="sylius.context.cart" priority="-555" />

    BitBag\SyliusMultiCartPlugin\Cart\Context\ShopBasedMultiCartContext:
        decorates: 'sylius.context.cart.new_shop_based'
        arguments:
            - '@sylius.context.cart.new_shop_based.inner'
            - '@sylius.context.shopper'
            - '@sylius.repository.order'
        tags:
            - {name: 'kernel.reset', method: 'reset'}


#    <argument type="service" id="sylius.context.cart.new_shop_based.inner" />
#    <argument type="service" id="sylius.context.shopper" />
#    <tag name="kernel.reset" method="reset" />
#    </service>